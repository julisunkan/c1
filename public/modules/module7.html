<div class="max-w-4xl mx-auto p-6 bg-slate-900 text-slate-100">
  <h1 class="text-3xl font-bold mb-6 text-slate-100">Module 7: Post-Exploitation and Lateral Movement</h1>
  
  <p class="text-slate-300 mb-6 text-lg leading-relaxed">
    Post-exploitation activities focus on maintaining access, gathering intelligence, and moving laterally through networks after initial compromise. This module covers persistence mechanisms, credential harvesting, and advanced attack techniques.
  </p>

  <h2 class="text-2xl font-semibold text-slate-100 mb-4">Learning Objectives</h2>
  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <ul class="text-slate-300 space-y-2">
      <li>• Master post-exploitation techniques for maintaining persistent access</li>
      <li>• Learn credential harvesting and password attack methodologies</li>
      <li>• Understand lateral movement techniques across network environments</li>
      <li>• Practice data collection and exfiltration methods</li>
      <li>• Implement anti-forensics and evasion techniques</li>
      <li>• Execute advanced persistent threat (APT) simulation scenarios</li>
    </ul>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Persistence Mechanisms</h3>
  <p class="text-slate-300 mb-4">
    Establishing persistence ensures continued access to compromised systems across reboots and security updates.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Windows Persistence</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Registry Run Keys:</strong> Autostart applications</li>
        <li>• <strong>Scheduled Tasks:</strong> Recurring execution</li>
        <li>• <strong>Service Installation:</strong> System-level persistence</li>
        <li>• <strong>WMI Event Subscriptions:</strong> Stealth persistence</li>
        <li>• <strong>DLL Hijacking:</strong> Library replacement</li>
        <li>• <strong>Startup Folder:</strong> User-level autostart</li>
      </ul>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Linux Persistence</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Cron Jobs:</strong> Scheduled task execution</li>
        <li>• <strong>Systemd Services:</strong> Service-based persistence</li>
        <li>• <strong>SSH Key Installation:</strong> Authentication bypass</li>
        <li>• <strong>Init Scripts:</strong> Boot-time execution</li>
        <li>• <strong>Profile Scripts:</strong> Shell startup persistence</li>
        <li>• <strong>Library Injection:</strong> Shared library hijacking</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Credential Harvesting</h3>
  <p class="text-slate-300 mb-4">
    Extracting credentials enables lateral movement and privilege escalation across network environments.
  </p>

  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <h4 class="text-lg font-semibold text-slate-100 mb-3">Windows Credential Extraction</h4>
    <div class="space-y-3">
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Mimikatz</h5>
        <p class="text-slate-300 text-sm mb-1">Extract plaintext passwords from memory</p>
        <code class="text-green-400 text-sm">sekurlsa::logonpasswords</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">SAM Database</h5>
        <p class="text-slate-300 text-sm mb-1">Extract password hashes from SAM</p>
        <code class="text-green-400 text-sm">reg save HKLM\SAM sam.hive</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">LSASS Memory Dump</h5>
        <p class="text-slate-300 text-sm mb-1">Extract credentials from LSASS process</p>
        <code class="text-green-400 text-sm">procdump -ma lsass.exe lsass.dmp</code>
      </div>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Password Attacks</h3>
  <p class="text-slate-300 mb-4">
    Password attacks help crack extracted hashes and gain access to additional accounts and systems.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Hash Cracking Tools</h4>
      <div class="space-y-2">
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">hashcat -m 1000 hashes.txt rockyou.txt</code>
          <span class="text-slate-300 text-xs ml-2">NTLM hash cracking</span>
        </div>
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">john --format=NT hashes.txt</code>
          <span class="text-slate-300 text-xs ml-2">John the Ripper</span>
        </div>
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">hydra -L users.txt -P passwords.txt ssh://target</code>
          <span class="text-slate-300 text-xs ml-2">Online brute force</span>
        </div>
      </div>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Attack Techniques</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Dictionary Attacks:</strong> Common password lists</li>
        <li>• <strong>Rule-Based Attacks:</strong> Password mutation rules</li>
        <li>• <strong>Hybrid Attacks:</strong> Dictionary + brute force</li>
        <li>• <strong>Mask Attacks:</strong> Pattern-based cracking</li>
        <li>• <strong>Rainbow Tables:</strong> Precomputed hash lookups</li>
        <li>• <strong>Pass-the-Hash:</strong> Use hashes without cracking</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Lateral Movement Techniques</h3>
  <p class="text-slate-300 mb-4">
    Lateral movement allows attackers to expand access across network segments and reach high-value targets.
  </p>

  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <h4 class="text-lg font-semibold text-slate-100 mb-3">Windows Lateral Movement</h4>
    <div class="space-y-3">
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">PSExec</h5>
        <p class="text-slate-300 text-sm mb-1">Remote command execution via SMB</p>
        <code class="text-green-400 text-sm">psexec \\target -u domain\user -p password cmd</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">WMI Execution</h5>
        <p class="text-slate-300 text-sm mb-1">Windows Management Instrumentation</p>
        <code class="text-green-400 text-sm">wmic /node:target process call create "cmd.exe"</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">PowerShell Remoting</h5>
        <p class="text-slate-300 text-sm mb-1">Remote PowerShell sessions</p>
        <code class="text-green-400 text-sm">Enter-PSSession -ComputerName target -Credential $cred</code>
      </div>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Active Directory Attacks</h3>
  <p class="text-slate-300 mb-4">
    Active Directory environments present unique opportunities for lateral movement and privilege escalation.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Kerberos Attacks</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Kerberoasting:</strong> Extract service account hashes</li>
        <li>• <strong>ASREPRoasting:</strong> Accounts without pre-authentication</li>
        <li>• <strong>Golden Ticket:</strong> Forge Kerberos tickets</li>
        <li>• <strong>Silver Ticket:</strong> Service-specific tickets</li>
        <li>• <strong>Pass-the-Ticket:</strong> Reuse stolen tickets</li>
        <li>• <strong>Overpass-the-Hash:</strong> Convert NTLM to Kerberos</li>
      </ul>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Domain Enumeration</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>BloodHound:</strong> AD relationship mapping</li>
        <li>• <strong>PowerView:</strong> PowerShell AD enumeration</li>
        <li>• <strong>ADRecon:</strong> Comprehensive AD discovery</li>
        <li>• <strong>ldapsearch:</strong> LDAP directory queries</li>
        <li>• <strong>enum4linux:</strong> SMB and LDAP enumeration</li>
        <li>• <strong>rpcclient:</strong> Windows RPC enumeration</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Data Collection and Exfiltration</h3>
  <p class="text-slate-300 mb-4">
    Systematic data collection helps identify valuable information and plan exfiltration strategies.
  </p>

  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <h4 class="text-lg font-semibold text-slate-100 mb-3">Data Discovery Techniques</h4>
    <div class="space-y-3">
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">File System Search</h5>
        <code class="text-green-400 text-sm">find / -name "*.doc*" -o -name "*.xls*" -o -name "*.pdf" 2>/dev/null</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Content-Based Search</h5>
        <code class="text-green-400 text-sm">grep -r "password\|ssn\|credit" /home/ 2>/dev/null</code>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Database Enumeration</h5>
        <code class="text-green-400 text-sm">sqlcmd -S server -E -Q "SELECT name FROM sys.databases"</code>
      </div>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Network Pivoting</h3>
  <p class="text-slate-300 mb-4">
    Network pivoting enables access to internal network segments through compromised systems.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Port Forwarding</h4>
      <div class="space-y-2">
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">ssh -L 8080:internal-server:80 user@pivot</code>
          <span class="text-slate-300 text-xs ml-2">Local port forward</span>
        </div>
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">ssh -R 8080:localhost:80 user@external</code>
          <span class="text-slate-300 text-xs ml-2">Reverse port forward</span>
        </div>
        <div class="bg-slate-900 rounded p-2">
          <code class="text-green-400 text-sm">portfwd add -l 8080 -p 80 -r 192.168.1.10</code>
          <span class="text-slate-300 text-xs ml-2">Meterpreter portfwd</span>
        </div>
      </div>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">SOCKS Proxying</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>SSH SOCKS Proxy:</strong> Dynamic port forwarding</li>
        <li>• <strong>Proxychains:</strong> Route traffic through proxy chains</li>
        <li>• <strong>Chisel:</strong> Fast TCP/UDP tunnel over HTTP</li>
        <li>• <strong>Ligolo:</strong> Simple and lightweight tunneling tool</li>
        <li>• <strong>Revsocks:</strong> Reverse SOCKS proxy</li>
        <li>• <strong>Rpivot:</strong> Reverse connection SOCKS proxy</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Covert Channels and Communications</h3>
  <p class="text-slate-300 mb-4">
    Covert channels help maintain stealthy communications and evade network monitoring.
  </p>

  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <h4 class="text-lg font-semibold text-slate-100 mb-3">Communication Methods</h4>
    <div class="space-y-3">
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">DNS Tunneling</h5>
        <p class="text-slate-300 text-sm">Hide data in DNS queries and responses</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">ICMP Tunneling</h5>
        <p class="text-slate-300 text-sm">Embed data in ICMP ping packets</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">HTTP/HTTPS Tunneling</h5>
        <p class="text-slate-300 text-sm">Use legitimate web traffic for communication</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Steganography</h5>
        <p class="text-slate-300 text-sm">Hide data within image or document files</p>
      </div>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Anti-Forensics Techniques</h3>
  <p class="text-slate-300 mb-4">
    Anti-forensics techniques help conceal attack activities and complicate incident response efforts.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Log Manipulation</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Event Log Clearing:</strong> Remove Windows event logs</li>
        <li>• <strong>Syslog Manipulation:</strong> Modify Linux system logs</li>
        <li>• <strong>Timestamp Modification:</strong> Alter file creation times</li>
        <li>• <strong>Log Injection:</strong> Insert false log entries</li>
        <li>• <strong>Service Manipulation:</strong> Disable logging services</li>
        <li>• <strong>Registry Modification:</strong> Hide evidence in registry</li>
      </ul>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Data Destruction</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Secure Deletion:</strong> Overwrite file data multiple times</li>
        <li>• <strong>Memory Clearing:</strong> Clear sensitive data from RAM</li>
        <li>• <strong>Artifact Removal:</strong> Delete temporary and cache files</li>
        <li>• <strong>Tool Cleanup:</strong> Remove attack tools and scripts</li>
        <li>• <strong>Network Traces:</strong> Clear network connection logs</li>
        <li>• <strong>Process Hiding:</strong> Conceal malicious processes</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Advanced Persistent Threat (APT) Simulation</h3>
  <p class="text-slate-300 mb-4">
    APT simulation helps organizations understand and defend against sophisticated, long-term attack campaigns.
  </p>

  <div class="bg-slate-800 border border-slate-700 rounded-lg p-6 mb-6">
    <h4 class="text-lg font-semibold text-slate-100 mb-3">APT Campaign Phases</h4>
    <div class="space-y-3">
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Initial Compromise</h5>
        <p class="text-slate-300 text-sm">Spear phishing, watering hole attacks, supply chain compromise</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Establish Foothold</h5>
        <p class="text-slate-300 text-sm">Deploy backdoors, establish persistence, evade detection</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Escalate Privileges</h5>
        <p class="text-slate-300 text-sm">Local privilege escalation, credential harvesting</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Internal Reconnaissance</h5>
        <p class="text-slate-300 text-sm">Network mapping, system enumeration, target identification</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Move Laterally</h5>
        <p class="text-slate-300 text-sm">Spread across network, compromise additional systems</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Maintain Presence</h5>
        <p class="text-slate-300 text-sm">Long-term persistence, multiple access methods</p>
      </div>
      <div class="bg-slate-900 rounded p-3">
        <h5 class="font-semibold text-slate-100 mb-1">Complete Mission</h5>
        <p class="text-slate-300 text-sm">Data exfiltration, system disruption, or other objectives</p>
      </div>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Red Team Frameworks</h3>
  <p class="text-slate-300 mb-4">
    Professional red team frameworks provide structured approaches to post-exploitation activities.
  </p>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Cobalt Strike</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• Commercial adversary simulation platform</li>
        <li>• Beacon payload for persistent access</li>
        <li>• Team collaboration and reporting features</li>
        <li>• Malleable C2 profiles for evasion</li>
        <li>• Sleep obfuscation and OPSEC features</li>
      </ul>
    </div>
    <div class="bg-slate-800 rounded-lg p-4">
      <h4 class="text-lg font-semibold text-slate-100 mb-2">Open Source Alternatives</h4>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• <strong>Empire:</strong> PowerShell post-exploitation</li>
        <li>• <strong>Covenant:</strong> .NET command and control</li>
        <li>• <strong>Merlin:</strong> Cross-platform HTTP/2 C2</li>
        <li>• <strong>Sliver:</strong> Open source C2 framework</li>
        <li>• <strong>PoshC2:</strong> PowerShell C2 server</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Practical Exercises</h3>
  <p class="text-slate-300 mb-4">
    Practice exercises help develop post-exploitation skills in realistic scenarios.
  </p>

  <div class="space-y-4 mb-6">
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-4">
      <h5 class="font-semibold text-slate-100 mb-2">Exercise 1: Persistence and Credential Harvesting</h5>
      <p class="text-slate-300 text-sm mb-2">Establish persistence and harvest credentials:</p>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• Install backdoors on compromised Windows system</li>
        <li>• Extract credentials using Mimikatz</li>
        <li>• Crack password hashes with Hashcat</li>
        <li>• Test persistence across system reboots</li>
      </ul>
    </div>
    
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-4">
      <h5 class="font-semibold text-slate-100 mb-2">Exercise 2: Lateral Movement Simulation</h5>
      <p class="text-slate-300 text-sm mb-2">Practice lateral movement techniques:</p>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• Use PsExec for remote command execution</li>
        <li>• Perform Kerberoasting against service accounts</li>
        <li>• Enumerate Active Directory with BloodHound</li>
        <li>• Pivot through network segments using port forwarding</li>
      </ul>
    </div>
    
    <div class="bg-slate-800 border border-slate-700 rounded-lg p-4">
      <h5 class="font-semibold text-slate-100 mb-2">Exercise 3: APT Campaign Simulation</h5>
      <p class="text-slate-300 text-sm mb-2">Execute complete APT-style attack campaign:</p>
      <ul class="text-slate-300 text-sm space-y-1">
        <li>• Plan multi-stage attack with specific objectives</li>
        <li>• Deploy covert communication channels</li>
        <li>• Maintain long-term access while avoiding detection</li>
        <li>• Document attack timeline and techniques used</li>
      </ul>
    </div>
  </div>

  <h3 class="text-xl font-semibold text-slate-100 mb-4">Key Takeaways</h3>
  <p class="text-slate-300 mb-6">
    Post-exploitation and lateral movement represent the critical phases where attackers maximize their impact and achieve their objectives. This module covered persistence mechanisms, credential harvesting, lateral movement techniques, and advanced attack simulation. Understanding these techniques helps organizations improve their detection capabilities and incident response procedures. Remember that post-exploitation activities should always be conducted within authorized scope and with proper documentation for security improvement purposes. The techniques covered here reflect real-world attack patterns used by sophisticated threat actors.
  </p>
</div>